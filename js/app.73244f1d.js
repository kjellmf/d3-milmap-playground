(function(t){function e(e){for(var o,i,n=e[0],l=e[1],c=e[2],u=0,h=[];u<n.length;u++)i=n[u],a[i]&&h.push(a[i][0]),a[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);p&&p(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],o=!0,n=1;n<r.length;n++){var l=r[n];0!==a[l]&&(o=!1)}o&&(s.splice(e--,1),t=i(i.s=r[0]))}return t}var o={},a={app:0},s=[];function i(e){if(o[e])return o[e].exports;var r=o[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=o,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var p=l;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("cd49")},"46a5":function(t,e,r){},"5c0b":function(t,e,r){"use strict";var o=r("5e27"),a=r.n(o);a.a},"5e27":function(t,e,r){},"76f1":function(t,e,r){"use strict";var o=r("46a5"),a=r.n(o);a.a},cd49:function(t,e,r){"use strict";r.r(e);var o=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container is-fluid",attrs:{id:"app"}},[r("div",{staticClass:"columns is-marginless"},[r("div",{staticClass:"column mapview"},[r("GlobeMap",{ref:"gmap",attrs:{rotation:t.rotation,scale:t.scale}},[r("MapSymbolLayer",{attrs:{layer:t.layer}})],1)],1),r("div",{staticClass:"column is-4 has-background-white-bis sidebar"},[t._m(0),r("div",[r("button",{staticClass:"button",on:{click:t.toggleSpin}},[t._v("Toggle spin")])]),r("MarkerList",{attrs:{markers:t.layer},on:{markerSelect:t.onMarkerSelect}})],1)])])},s=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[r("h1",[t._v("D3 map experiment")])])}],i=r("be94"),n=r("9ab4"),l=r("60a3"),c=r("b5ae"),p=(r("ac6a"),r("fd32")),u=r("9fc0"),h=r("6eee"),d=r("3fe2"),m=r("b108"),y=r("a43d"),f=r("d61f"),b=r.n(f);const g=r("517f"),v="10030100001101000000",j=430,O=[0,0,0];class k{constructor(t,e,r,o){this.centerPos=[0,0],this.refreshCallbacks=[],this.width=e,this.height=r;let a=Object(u["c"])().clipAngle(90).scale(o.scale||j).translate([e/2,r/2]).rotate(O);this.pathGenerator=Object(u["d"])().projection(a).pointRadius(1.5),this.svg=Object(p["f"])(t),this.proj=a,this.createGlobe(),Object(h["a"])().projection(a).onMove(t=>this.refresh())(this.svg.node())}createGlobe(){let t=this.svg,e=this.proj,r=this.pathGenerator,o=Object(u["b"])();t.append("circle").attr("cx",this.width/2).attr("cy",this.height/2).attr("r",e.scale()).attr("class","earth-circle noclicks").attr("fill","none"),t.append("path").data(d["a"](g,g.objects.land).features).attr("class","land").attr("d",r),t.append("path").datum(o).attr("class","graticule noclicks").attr("d",r)}refresh(){let t=this.proj,e=this.pathGenerator;this.centerPos=t.invert([this.width/2,this.height/2]);let r=this.svg;r.selectAll(".earth-circle").attr("r",t.scale()),r.selectAll(".land").attr("d",e),r.selectAll(".countries path").attr("d",e),r.selectAll(".graticule").attr("d",e),this.refreshCallbacks.forEach(t=>t())}registerRefreshCallback(t){this.refreshCallbacks.push(t)}set rotation(t){this.proj.rotate(t),this.refresh()}get rotation(){return this.proj.rotate()}rotateTo(t){let e=this,r=this.proj;Object(m["b"])().duration(2e3).tween("rotate",()=>{let o=Object(y["a"])(r.rotate(),[-t[0],-t[1],0]);return function(t){r.rotate(o(t)),e.refresh()}})}}class _{constructor(t,e){this.layer=t,this.mapContainer=e;let r=this.mapContainer,o=(r.proj,r.svg);o.append("g").attr("class","symbols").selectAll("g").data(this.layer.features).enter().append("g").attr("class","symbol").html(t=>{let e=t.properties.sidc||v,r=new f["Symbol"](e,{size:20});return t.s=r,r.asSVG()}),this.positionSymbols(),e.registerRefreshCallback(()=>{this.positionSymbols()})}positionSymbols(){let t=this.mapContainer,e=t.proj,r=t.svg,o=t.centerPos;r.selectAll(".symbol").attr("transform",t=>{let r=Object(u["a"])(t.geometry.coordinates,o),a=1;r>1&&(a=1-1.25*(r-1));let s=e(t.geometry.coordinates),i=s[0],n=s[1],l=-t.s.octagonAnchor.x,c=-t.s.octagonAnchor.y;return`translate(${i}, ${n}) scale(${a}) translate(${l}, ${c})`}).style("display",t=>{let e=Object(u["a"])(t.geometry.coordinates,o);return e>1.57?"none":"inline"})}}let C=class extends o["default"]{constructor(){super(...arguments),this.isMounted=!1}mounted(){this.mapContainer=this.globeData.mapContainer,this.symbolLayer=new _(this.layer,this.mapContainer)}get centerPos(){return this.mapContainer.centerPos}render(t){return null}};n["a"]([Object(l["c"])({type:Object})],C.prototype,"layer",void 0),n["a"]([Object(l["b"])()],C.prototype,"globeData",void 0),C=n["a"]([l["a"]],C);var S,M,P=C,w=P,x=r("2877"),F=Object(x["a"])(w,S,M,!1,null,null,null);F.options.__file="MapSymbolLayer.vue";var N=F.exports;const $={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"N1",sidc:"10032000001213010000"},geometry:{type:"Point",coordinates:[-122.41716877355225,37.76919562968743]}},{type:"Feature",properties:{name:"N2"},geometry:{type:"Point",coordinates:[-87.75200083270931,41.83193651927843]}},{type:"Feature",properties:{name:"N3"},geometry:{type:"Point",coordinates:[-118.243683,34.052235]}},{type:"Feature",properties:{name:"N4"},geometry:{type:"Point",coordinates:[-123.116226,49.246292]}},{type:"Feature",properties:{name:"N5"},geometry:{type:"Point",coordinates:[-114.062019,51.04427]}},{type:"Feature",properties:{name:"N6"},geometry:{type:"Point",coordinates:[2.154007,41.390205]}},{type:"Feature",properties:{"marker-color":"#7e7e7e","marker-size":"medium","marker-symbol":"",name:"",sidc:10010100001103e6},geometry:{type:"Point",coordinates:[141.328125,37.71859032558816]}},{type:"Feature",properties:{name:"N7"},geometry:{type:"Point",coordinates:[2.349014,48.864716]}},{type:"Feature",properties:{name:"N8"},geometry:{type:"Point",coordinates:[6.953101,50.935173]}},{type:"Feature",properties:{name:"N9"},geometry:{type:"Point",coordinates:[6.143158,46.204391]}},{type:"Feature",properties:{name:"N10",sidc:10063000001201e6},geometry:{type:"Point",coordinates:[91.0546875,-9.44906182688142]}},{type:"Feature",properties:{name:"N11",sidc:"10033000001201000001"},geometry:{type:"Point",coordinates:[-20,0]}},{type:"Feature",properties:{name:"N12",sidc:"10063500001101000006"},geometry:{type:"Point",coordinates:[-30,1]}},{type:"Feature",properties:{name:"N12",sidc:"10032500001313000000"},geometry:{type:"Point",coordinates:[0,90]}},{type:"Feature",properties:{name:"N12",sidc:"10032500001602050000"},geometry:{type:"Point",coordinates:[0,-90]}},{type:"Feature",properties:{name:"N12",sidc:"10033000001401090000"},geometry:{type:"Point",coordinates:[-155,20]}}]};var A=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"panel"},[r("p",{staticClass:"panel-heading"},[t._v("\n    Markers\n  ")]),t._l(t.features,function(e,o){return r("a",{key:o,staticClass:"panel-block",on:{click:function(r){t.onMarkerClick(e)}}},[r("span",{staticClass:"panel-icon"},[r("MilSymbol",{attrs:{size:12,sidc:e.properties.sidc||t.DEFAULT_SIDC}})],1),t._v("\n    "+t._s(e.properties.name)+"\n  ")])})],2)},T=[],D=o["default"].extend({name:"MilSymbol",props:{sidc:[String,Number],size:{type:Number,default:15},modifiers:{type:Object}},render(t){let e=new b.a.Symbol(this.sidc,{size:this.size,simpleStatusModifier:!0},this.modifiers||{});return t("span",{attrs:{class:"milsymbol"},domProps:{innerHTML:e.asSVG()}})}});const G="10030100001101000000";let L=class extends l["e"]{constructor(){super(...arguments),this.DEFAULT_SIDC=G}get features(){return this.markers.features}onMarkerClick(t){this.$emit("markerSelect",t)}};n["a"]([Object(l["c"])({required:!0,type:Object})],L.prototype,"markers",void 0),L=n["a"]([Object(l["a"])({components:{MilSymbol:D}})],L);var R=L,E=R,z=Object(x["a"])(E,A,T,!1,null,null,null);z.options.__file="MarkerList.vue";var I=z.exports,J=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("svg",{staticClass:"map-container",attrs:{viewBox:"0 0 "+t.width+" "+t.height}},[t.isMounted?t._t("default"):t._e()],2)},U=[];const V=900,q=900;let B=class extends o["default"]{constructor(){super(...arguments),this.isMounted=!1,this.width=V,this.height=q,this.globeData={}}mounted(){this.d3g=new k(this.$el,this.width,this.height,{scale:this.scale}),this.globeData.mapContainer=this.d3g,this.isMounted=!0}onRotationChange(t){this.d3g.rotation=t}getRotation(){return this.d3g.rotation}rotateTo(t){this.d3g.rotateTo(t)}};n["a"]([Object(l["c"])()],B.prototype,"rotation",void 0),n["a"]([Object(l["c"])({type:Number})],B.prototype,"scale",void 0),n["a"]([Object(l["d"])()],B.prototype,"globeData",void 0),n["a"]([Object(l["f"])("rotation",{deep:!0})],B.prototype,"onRotationChange",null),B=n["a"]([l["a"]],B);var H=B,K=H,Q=(r("76f1"),Object(x["a"])(K,J,U,!1,null,null,null));Q.options.__file="GlobeMap.vue";var W=Q.exports;const X=[.015,-.005];let Y=[19.666666666666664,-30,0],Z=class extends l["e"]{constructor(){super(...arguments),this.rotation=Y,this.scale=400,this.layer=$,this.spin=!1}mounted(){}onMarkerSelect(t){console.log("Selected",Object(i["a"])({},t.properties));let e=t.geometry.coordinates;this.$refs.gmap.rotateTo(e)}toggleSpin(){this.spin?(this.timer&&(this.timer.stop(),Y=this.$refs.gmap.getRotation()),this.spin=!1):(this.timer&&this.timer.stop(),Y=this.$refs.gmap.getRotation(),this.timer=Object(c["c"])(t=>{this.rotation=[Y[0]+X[0]*t,Y[1]+X[1]*t,Y[2]]}),this.spin=!0)}};Z=n["a"]([Object(l["a"])({components:{GlobeMap:W,MarkerList:I,MapSymbolLayer:N}})],Z);var tt=Z,et=tt,rt=(r("5c0b"),Object(x["a"])(et,a,s,!1,null,null,null));rt.options.__file="App.vue";var ot=rt.exports;r("92c6");o["default"].config.productionTip=!1,new o["default"]({render:t=>t(ot)}).$mount("#app")}});
//# sourceMappingURL=app.73244f1d.js.map